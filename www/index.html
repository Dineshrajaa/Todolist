<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8" />
        <script type="text/javascript" src="js/jquery-2.1.1.js"></script>
        <script type="text/javascript" src="js/jquery.mobile-1.4.5.js"></script>       
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.4.5.css" />
        
        <title>ToDoL</title>
        <script type="text/javascript">
        //Function to Add-todo
        function addToDo(){
            var titl=$("#todotitle").val();
            var description=$("#tododesc").val();
            if (titl!==""&&description!=="") {
                var db=window.openDatabase("ToDo",1.0,"ToDo",5242880);
                db.transaction(function(tx){
                    tx.executeSql("insert into todotable(title,desc) values(?,?)",[titl,description]);
                    //alert("Inserted Successfully");
                });
            }
            else alert("Enter all the data");
        }
        //Function to Display Todo's in Listview
        function showToDo(transaction,results){
            for(var i=0;i<results.rows.length;i++){
                var row=results.rows.item(i);
                $("#todolist").append("<li>"+row.title+"</li>");                
            }

                $("#todolist").listview("refresh");
        }
        //Function to read Todo's from DB
        function readToDo(){
            var db=window.openDatabase("ToDo",1.0,"ToDo",5242880);
            //$("#todolist").html("");
            db.transaction(function(tx){
                tx.executeSql("select * from todotable",[],showToDo);

            });
        }
        $(document).ready(function(){
            if (window.openDatabase) {
                var db=window.openDatabase("ToDo",1.0,"ToDo",5242880);
                db.transaction(function(tx){
                    tx.executeSql("create table if not exists todotable(todoid integer primary key asc,title text,desc text)");
                    //alert("Table Created");
                    readToDo();
                });
            }
            else{
                alert("Your Device donot support offline storage");
            }
            $("#savebtn").click(addToDo);
            
        });
        /*document.addEventListener('deviceready', function () {
           
        
}, false); */

        </script>
    </head>
    <body>
        <section id="home" data-role="page">
            <header data-role="header" data-theme="b">
                <h1>ToDoL</h1>
            </header>
            <article data-role="content">
            <center>
            
            <a href="#adderpage" id="adderbtn" data-inline="true" data-role="button" data-transition="pop">Add To-Do</a>

            <input type="button" id="removerbtn" data-inline="true" value="Remove Tasks">
            </center>
                <div id="maincontent">
                   <ul id="todolist" data-role="listview"></ul> 
                </div>
            </article>
            <footer data-role="footer" data-position="fixed" data-theme="b">
                <h1>&copy Reserved by Dinesh Raja</h1>
            </footer>
        </section>
        <section id="adderpage" data-role="page" data-dialog="true" data-close-btn="none">
            <header data-role="header" data-theme="b" >
                <h1>Add New To-Do</h1>
            </header>
            <article data-role="content">
            <form id="todoform">
                <label for="todotitle">Title:</label>
                <input type="text" id="todotitle" /><br/>
                <label for="tododesc">Description:</label>
                <textarea id="tododesc"></textarea><br/>
                <label for="tododate">Schedule Date</label>
                <input type="date" id="tododate" />
                <label for="todotime">Schedule Time</label>
                <input   type="time" id="todotime" /><br/>
                <!--<input type="button" id="savebtn" value="Save" data-inline="true" /> -->
                <a href="#" id="savebtn" data-role="button" data-inline="true" data-rel="back">Save</a>          
                <a href="#" data-role="button" data-inline="true" data-rel="back" id="cancelbtn"> Cancel</a>
            </form>
            </article>
        </section>
    </body>
</html>
<!--Things yet to be done
    Read and save Schedule date and time in DB
    Add Local Notification support
-->